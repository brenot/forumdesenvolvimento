function ytplquery(){if(jQuery("#ytplerror").html(""),jQuery("#ytplresult").html(""),key=document.getElementById("jform_params_apiKey").value,forUsername=document.getElementById("userName").value,!key)return void jQuery("#ytplerror").html("<br>API key not set.");if(!forUsername)return void jQuery("#ytplerror").html("<br>Channel not set.");var e={};jQuery.ajaxSetup({async:!1});var t={part:"contentDetails",forUsername:forUsername,key:key};if(jQuery.getJSON("https://www.googleapis.com/youtube/v3/channels",t).done(function(t){"undefined"!=typeof t.items[0]?(channelId=t.items[0].id,"undefined"!=typeof t.items[0].contentDetails.relatedPlaylists&&jQuery.each(t.items[0].contentDetails.relatedPlaylists,function(t,r){e[r]=t})):channelId=!1}).fail(function(e,t,r){var n=t+", "+r;"undefined"!=typeof e.responseJSON.error.message&&(n=n+"<br>"+e.responseJSON.error.message),jQuery("#ytplerror").html("<br>Request Failed: "+n)}),channelId){var t={part:"id,snippet",channelId:channelId,key:key};jQuery.getJSON("https://www.googleapis.com/youtube/v3/playlists",t).done(function(t){"undefined"!=typeof t.items&&t.items.each(function(t){e[t.id]=t.snippet.title})}).fail(function(e,t,r){var n=t+", "+r;"undefined"!=typeof e.responseJSON.error.message&&(n=n+"<br>"+e.responseJSON.error.message),jQuery("#ytplerror").html("<br>Request Failed: "+n)})}if(jQuery.isEmptyObject(e))jQuery("#ytplerror").html("<br>Channel or playlists not found.");else{jQuery("#ytplresult").html("<br>");var r=jQuery("<select onchange=\"document.getElementById('jform_params_playList').value = this.value;\">").appendTo("#ytplresult");r.append(jQuery("<option>").attr("value","").text("Select a playlist")),jQuery.each(e,function(e,t){r.append(jQuery("<option>").attr("value",e).text(t))})}}